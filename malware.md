
# Lezione su Malware e Rilevamento del Malware

Questa lezione fornisce una panoramica completa sui **malware** (software dannosi), sui loro meccanismi di diffusione e azione, sulle strategie di classificazione e sulle tecniche di rilevamento.  
L’obiettivo è comprendere come funzionano le minacce informatiche e quali strumenti e metodologie vengono utilizzati per contrastarle, con particolare attenzione alla prevenzione e al rilevamento efficace, riducendo i falsi allarmi.

---

## 1. Definizione e rilevanza del malware

Il termine **malware** (malicious software) si riferisce a qualsiasi programma creato con l’intento di danneggiare o sfruttare un sistema informatico, una rete o un utente. La lezione parte dal problema centrale:

> *Come prevenire e rilevare in modo efficace nuovi malware senza produrre troppi falsi allarmi?*

Il documento mostra subito dati statistici provenienti da **ENISA Threat Landscape 2025**, in cui si evidenzia che la maggior parte delle minacce identificate sono **WebThreats (83.5%)**, seguite da **Mobile Threats (42.4%)**, **Supply Chain (10.6%)**, **RAT (Remote Access Trojan, 1.2–5%)** e **Stealer (1.2%)**.

---

## 2. Classificazione del malware

Il malware può essere classificato secondo diverse prospettive:

- **Modalità di diffusione**: come raggiunge i bersagli (es. vulnerabilità software, social engineering).
- **Azioni (payload)**: cosa fa una volta infiltrato (es. furto di dati, criptaggio file, creazione di backdoor).
- **Autonomia**:  
  – *Parassiti* (virus) richiedono un programma ospite.  
  – *Indipendenti* (worm, trojan, bot) sono eseguibili autonomamente.
- **Capacità di replicazione**:  
  – *Non replicanti*: trojan, spam.  
  – *Replicanti*: virus, worm.

**Strumenti open-source per la classificazione**:
- **AVClass/AVClass2**: estrae automaticamente etichette dai report degli antivirus.
- **YARA**: consente di creare regole basate su pattern testuali o binari per identificare famiglie di malware.

---

## 3. Tipologie di malware

Viene presentata una tassonomia dettagliata con tabelle che descrivono caratteristiche e comportamenti:

- **Advanced Persistent Threat (APT)**: attacchi mirati e persistenti, spesso sponsorizzati da stati-nazione.
- **Adware**: software che mostra pubblicità indesiderata.
- **Attack Kit**: toolkit per generare malware automaticamente.
- **Backdoor/Trapdoor**: bypass delle normali procedure di sicurezza.
- **Botnet/Zombie**: sistema controllato da remoto per attacchi coordinati.
- **Downloader**: codice che scarica altri malware.
- **Drive-by download**: sfrutta vulnerabilità del browser durante la navigazione.
- **Exploit**: codice che sfrutta specifiche vulnerabilità.
- **Flooder/DoS client**: genera traffico per attacchi Denial of Service.
- **Keylogger**: registra le sequenze di tasti premuti.
- **Logic Bomb**: attivato al verificarsi di condizioni specifiche.
- **Macro Virus**: infetta documenti con macro.
- **Mobile Code**: software eseguibile su più piattaforme senza modifiche.
- **Ransomware**: cripta file e richiede un riscatto.
- **Rootkit**: nasconde la presenza di malware.
- **Spammer**: invia grandi volumi di email indesiderate.
- **Spyware**: raccoglie informazioni di sistema.
- **Trojan Horse**: sembra legittimo ma nasconde funzionalità malevole.
- **Virus**: infetta file eseguibili replicandosi.
- **Worm**: si propaga autonomamente attraverso la rete.
- **Wiper**: cancella dati in modo irreversibile.

---

## 4. Virus e loro componenti

Il virus è un tipo di malware che:
- Infetta programmi modificandoli per includere una copia di sé stesso.
- Si replica e infetta altro contenuto.
- Può diffondersi rapidamente in ambienti di rete.
- È specifico per sistema operativo e hardware.

**Componenti di un virus**:
1. **Meccanismo di infezione** (vettore di infezione).
2. **Trigger** (innesco, es. data/ora, azione utente).
3. **Payload** (azioni dannose oltre alla replicazione).

**Classificazione dei virus**:
- Per **bersaglio**: boot sector, file, macro, multipartite.
- Per **strategia di occultamento**: criptato, stealth, polimorfico, metamorfico.

---

## 5. Storia dei malware

Viene ripercorsa una timeline significativa:
- **1982**: Elk Cloner (primo virus per Apple II).
- **1988**: Morris worm (primo worm diffuso su ARPANET).
- **1999**: Melissa (virus via email).
- **2000**: ILOVEYOU (worm email con script).
- **2001**: Code Red (worm contro server web).
- **2013**: CryptoLocker (ransomware diffuso via botnet).
- **2017**: WannaCry e NotPetya (sfruttano EternalBlue).
- **2021**: Pegasus spyware (zero-click exploit su iOS/Android).

---

## 6. Ransomware ed evoluzione

Il ransomware è diventato una minaccia predominante:
- **1989**: primo caso con criptaggio nomi file.
- **2005–2009**: primi esempi con criptaggio semplice.
- **2013**: CryptoLocker introduce RSA a 2048 bit.
- **2016**: Ransomware as a Service (RaaS).
- **2017**: WannaCry e NotPetya causano miliardi di dollari di danni.

Casi di studio:
- **Conti Group** attacca il servizio sanitario irlandese (HSE).
- **Colonial Pipeline** viene compromesso tramite una password trapelata nel dark web.

---

## 7. Tecniche avanzate e APT

Gli **Advanced Persistent Threat** sono attacchi sofisticati e mirati:
- Sfruttano più vettori (cyber, fisici, ingegneria sociale).
- Mantengono accesso persistente nei sistemi bersaglio.
- Esempio: **Stuxnet** (2010), progettato per sabotare centrifughe nucleari iraniane.

**Movimento laterale** (lateral movement):
- L’attaccante si sposta da una macchina compromessa ad altre nella stessa rete.
- Spesso senza uso di malware, sfruttando servizi di sistema e relazioni di trust.

---

## 8. Backdoor, rootkit e attacchi supply chain

- **Backdoor**: accesso nascosto a un sistema, spesso inserito in software legittimo.
- **Rootkit**: modifica il sistema operativo per nascondere attività malevole (es. hijacking delle system call).
- **Supply Chain Attack**: compromissione di componenti software legittimi (es. **Solorigate** – attacco alla catena di fornitura di SolarWinds).

---

## 9. Tecniche di diffusione secondarie

- **Drive-by download**: sfruttamento di vulnerabilità del browser durante la navigazione.
- **Clickjacking**: sovrapposizione di elementi invisibili per indurre clic involontari.
- **Social engineering**: manipolazione psicologica dell’utente.
- **Spyware avanzato**: es. **Pegasus**, in grado di sfruttare zero-click exploit su iOS/Android.

---

## 10. Rilevamento del malware

### Convenzioni di denominazione
- Standard **CARO**: Tipo, Piattaforma, Famiglia, Variante, Suffissi.
- Esempio: `W32/Agent.A!tr` (worm per Windows 32-bit, famiglia Agent, variante A, Trojan).

### Generazioni di software antivirus
1. **Prima generazione**: scanner semplici basati su signature.
2. **Seconda generazione**: scanner euristici e controllo integrità.
3. **Terza generazione**: trappole di attività (behavior-based).
4. **Quarta generazione**: protezione completa (scansione, controllo accessi, sandbox).

### Metodologie di rilevamento
- **Misuse-based (signature-based)**: bassi falsi positivi, inefficace contro minacce nuove.
- **Anomaly-based**: rileva comportamenti anomali, ma può generare molti falsi allarmi.

### Tecniche di analisi
- **Static analysis**: esame del codice senza esecuzione (scan di stringhe, analisi euristica).
- **Dynamic analysis**: esecuzione in ambiente controllato (sandbox) per osservare il comportamento.

### Valutazione degli antivirus
- **Detection rate**: percentuale di malware correttamente identificati.
- **False positive rate**: percentuale di software legittimo erroneamente segnalato.
- **Performance**: uso risorse, velocità di scansione.

### Strumenti di valutazione indipendenti
- **AV-Comparatives**: test in ambiente reale con ampia collezione di campioni.
- **AV-TEST**: istituto di ricerca tedesco per la sicurezza IT.

---

## 11. Piattaforme e risorse

- **VirusTotal**: servizio di scansione online che utilizza oltre 70 motori antivirus.
- **YARA**: linguaggio per creare regole di identificazione malware.
- **AVClass2**: tool per l’estrazione automatica di tag da etichette antivirus.

---

## Domande da esame

1. **Spiega la differenza tra virus, worm e trojan, fornendo un esempio per ciascuno.**
2. **Descrivi le principali strategie di classificazione del malware, includendo almeno due criteri di categorizzazione.**
3. **Cosa sono gli APT? Fornisci un esempio storico e spiega perché sono considerati particolarmente pericolosi.**
4. **Illustra le quattro generazioni di software antivirus, evidenziando i limiti e i punti di forza di ciascuna.**
5. **Che cos’è il ransomware? Descrivi l’evoluzione storica e menziona almeno due attacchi significativi.**
6. **Spiega la differenza tra rilevamento misuse-based e anomaly-based, includendo vantaggi e svantaggi.**
7. **Cosa si intende per “supply chain attack”? Porta l’esempio di Solorigate e descrine le fasi.**
8. **Descrivi il funzionamento di un rootkit e come può essere rilevato.**
9. **Quali sono le principali tecniche di social engineering utilizzate per diffondere malware?**
10. **Come viene valutata l’efficacia di un motore antivirus? Menziona almeno tre metriche significative.**

---

Questa lezione fornisce una base solida per comprendere il panorama delle minacce informatiche e le strategie difensive attuali, sottolineando l’importanza di un approccio multistrato e aggiornato per contrastare malware sempre più evoluti.
